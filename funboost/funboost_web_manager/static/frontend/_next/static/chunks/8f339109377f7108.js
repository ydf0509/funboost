(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,67236,61911,e=>{"use strict";var t=e.i(75254);let r=(0,t.default)("folder-kanban",[["path",{d:"M4 20h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.93a2 2 0 0 1-1.66-.9l-.82-1.2A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13c0 1.1.9 2 2 2Z",key:"1fr9dc"}],["path",{d:"M8 10v4",key:"tgpxqk"}],["path",{d:"M12 10v2",key:"hh53o1"}],["path",{d:"M16 10v6",key:"1d6xys"}]]);e.s(["FolderKanban",()=>r],67236);let s=(0,t.default)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]);e.s(["Users",()=>s],61911)},7670,e=>{"use strict";e.s(["default",0,function(){for(var e,t,r=0,s="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=function e(t){var r,s,a="";if("string"==typeof t||"number"==typeof t)a+=t;else if("object"==typeof t)if(Array.isArray(t)){var i=t.length;for(r=0;r<i;r++)t[r]&&(s=e(t[r]))&&(a&&(a+=" "),a+=s)}else for(s in t)t[s]&&(a&&(a+=" "),a+=s);return a}(e))&&(s&&(s+=" "),s+=t);return s}])},55600,e=>{"use strict";function t(e,t){let r=e.startsWith("/")?e:`/${e}`;window.location.port,t?.replace?window.location.replace(r):window.location.href=r}e.s(["navigateTo",()=>t])},18566,(e,t,r)=>{t.exports=e.r(76562)},80580,e=>{"use strict";var t=e.i(43476),r=e.i(71645),s=e.i(9165);let a="careProjectChanged",i=(0,r.createContext)(null);function l({children:e}){let[l,n]=(0,r.useState)([]),[o,c]=(0,r.useState)(null),[d,u]=(0,r.useState)(null),[h,p]=(0,r.useState)(!0),[m,f]=(0,r.useState)(null),y=(0,r.useMemo)(()=>new Set(l.map(e=>e.id)),[l]),x=(0,r.useCallback)(async()=>{try{p(!0),f(null);let e=await fetch("/api/user/projects",{credentials:"include",cache:"no-store"});if(!e.ok){if(401===e.status){n([]),c(null),p(!1);return}throw Error(`获取项目列表失败: ${e.status}`)}let t=await e.json();if(t.success&&t.data){let e=t.data.projects||[];n(e)}else throw Error(t.error||"获取项目列表失败")}catch(e){f(e instanceof Error?e.message:"获取项目列表失败"),console.error("获取项目列表失败:",e)}finally{p(!1)}},[]),v=(0,r.useCallback)(e=>{(async()=>{try{await (0,s.funboostFetch)("/funboost/set_care_project_name",{method:"POST",json:{care_project_name:e.code},cache:"no-store"}),u(e.code),window.dispatchEvent(new CustomEvent(a,{detail:{careProjectName:e.code}}))}catch(e){console.error("更新关注项目失败:",e)}})()},[]),k=(0,r.useCallback)(e=>y.has(e),[y]);(0,r.useEffect)(()=>{x()},[x]);let b=(0,r.useCallback)(async()=>{try{let e=await (0,s.funboostFetch)("/funboost/get_care_project_name",{cache:"no-store"});u(e?.care_project_name||"")}catch(e){console.error("获取关注项目失败:",e),u("")}},[]);(0,r.useEffect)(()=>{b()},[b]),(0,r.useEffect)(()=>{null===d||(d?c(l.find(e=>e.code===d)||null):c(null))},[d,l]),(0,r.useEffect)(()=>{let e=e=>{let t=e.detail;t&&"string"==typeof t.careProjectName?u(t.careProjectName):b()};return window.addEventListener(a,e),()=>{window.removeEventListener(a,e)}},[b]);let g=(0,r.useMemo)(()=>({projects:l,careProjectName:d??"",currentProject:o,setCurrentProject:v,isLoading:h,error:m,hasProjectAccess:k,refresh:x}),[l,d,o,v,h,m,k,x]);return(0,t.jsx)(i.Provider,{value:g,children:e})}function n(){let e=(0,r.useContext)(i);if(!e)throw Error("useProject must be used within ProjectProvider");return e}e.s(["ProjectProvider",()=>l,"useProject",()=>n])},9165,e=>{"use strict";var t=e.i(53956);async function r(e,s={}){let a=`${(0,t.getApiBaseUrl)()}${e}`,i=new Headers(s.headers),l=s.body;void 0!==s.json&&(i.set("Content-Type","application/json"),l=JSON.stringify(s.json));let n=await fetch(a,{...s,headers:i,body:l,credentials:"include"});if(401===n.status){try{localStorage.removeItem("user_permissions_cache"),localStorage.removeItem("current_project");let e=sessionStorage.getItem("last_401_redirect"),t=Date.now();if(e&&t-parseInt(e,10)<2e3)throw console.warn("检测到重定向循环，已阻止自动跳转"),Error("会话已过期，请刷新页面后重新登录");sessionStorage.setItem("last_401_redirect",t.toString())}catch(e){if(e instanceof Error&&e.message.includes("会话已过期"))throw e}throw window.location.href="/login",Error("未登录，请先登录")}let o=(n.headers.get("content-type")||"").includes("application/json")?await n.json():await n.text();if(!n.ok){let e=`请求失败：${n.status}`;throw"object"==typeof o&&o&&(e=o.msg||o.error||o.message||e),Error(e)}return o}async function s(e,t={}){let a=await r(e,t);if(!a.succ)throw Error(a.msg||"请求失败");return a.data}function a(e){let t=new URLSearchParams;return Object.entries(e).forEach(([e,r])=>{null!=r&&""!==r&&t.append(e,String(r))}),t.toString()}e.s(["apiFetch",()=>r,"buildQuery",()=>a,"funboostFetch",()=>s])},53956,e=>{"use strict";function t(){return""}function r(e){let t=e.startsWith("/")?e:`/${e}`;return`${t}`}e.s(["apiConfig",0,{get baseUrl(){return""},credentials:"include",defaultHeaders:{"Content-Type":"application/json"}},"buildApiUrl",()=>r,"getApiBaseUrl",()=>t])},75254,e=>{"use strict";var t=e.i(71645);let r=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)},s=(...e)=>e.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim();var a={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let i=(0,t.forwardRef)(({color:e="currentColor",size:r=24,strokeWidth:i=2,absoluteStrokeWidth:l,className:n="",children:o,iconNode:c,...d},u)=>(0,t.createElement)("svg",{ref:u,...a,width:r,height:r,stroke:e,strokeWidth:l?24*Number(i)/Number(r):i,className:s("lucide",n),...!o&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(d)&&{"aria-hidden":"true"},...d},[...c.map(([e,r])=>(0,t.createElement)(e,r)),...Array.isArray(o)?o:[o]])),l=(e,a)=>{let l=(0,t.forwardRef)(({className:l,...n},o)=>(0,t.createElement)(i,{ref:o,iconNode:a,className:s(`lucide-${r(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,l),...n}));return l.displayName=r(e),l};e.s(["default",()=>l],75254)},20777,e=>{"use strict";var t=e.i(43476);let r=(0,e.i(71645).forwardRef)(({href:e,children:r,className:s,prefetch:a,...i},l)=>(0,t.jsx)("a",{ref:l,href:e,className:s,...i,children:r}));r.displayName="StaticLink",e.s(["StaticLink",0,r])},93302,e=>{"use strict";var t=e.i(43476),r=e.i(71645),s=e.i(18566);let a="user_permissions_cache",i=(0,r.createContext)(null);function l(e,t){for(let r of e)if(r.includes("*")&&RegExp("^"+r.replace(/[.+?^${}()|[\]\\]/g,"\\$&").replace(/\*/g,".*")+"$").test(t))return!0;return!1}function n(){try{localStorage.removeItem(a)}catch{}}function o({children:e}){let o=(0,s.useRouter)(),[c,d]=(0,r.useState)(()=>{let e=function(){try{let e=localStorage.getItem(a);if(!e)return null;let{data:t,timestamp:r}=JSON.parse(e);if(Date.now()-r>=3e5)return localStorage.removeItem(a),null;return t}catch{return localStorage.removeItem(a),null}}();return e?{...e,loading:!1,error:null}:{permissions:[],permissionDetails:[],roles:[],userName:null,loading:!0,error:null,isAuthenticated:!1}}),u=(0,r.useMemo)(()=>new Set(c.permissions),[c.permissions]),h=(0,r.useCallback)(async()=>{try{d(e=>({...e,loading:!0,error:null}));let e=await fetch("/admin/api/user/permissions",{credentials:"include"});if(!e.ok){if(401===e.status){n(),d({permissions:[],permissionDetails:[],roles:[],userName:null,loading:!1,error:null,isAuthenticated:!1}),o.push("/login");return}throw Error(`获取权限失败: ${e.status}`)}let t=await e.json();if(t.success&&t.data){let e={permissions:t.data.permissions||[],permissionDetails:t.data.permission_details||[],roles:t.data.roles||[],userName:t.data.user_name||null,isAuthenticated:!0};try{localStorage.setItem(a,JSON.stringify({data:e,timestamp:Date.now()}))}catch{console.warn("无法保存权限缓存到 localStorage")}d(t=>({...t,...e,loading:!1,error:null}))}else throw Error(t.error||"获取权限失败")}catch(t){let e=t instanceof Error?t.message:"获取权限失败";d(t=>({...t,loading:!1,error:e})),console.error("获取用户权限失败:",t)}},[o]),p=(0,r.useCallback)(()=>{n(),d({permissions:[],permissionDetails:[],roles:[],userName:null,loading:!1,error:null,isAuthenticated:!1})},[]),m=(0,r.useCallback)((e,t)=>{let{permissions:r}=c;if(u.has(e))return!0;if(t){let r=`${t}:${e}`;if(u.has(r))return!0}return!!(l(r,e)||t&&l(r,`${t}:${e}`))||!1},[c.permissions,u]),f=(0,r.useCallback)((e,t)=>e.some(e=>m(e,t)),[m]),y=(0,r.useCallback)((e,t)=>e.every(e=>m(e,t)),[m]),x=(0,r.useCallback)((e,t,r)=>m(`${e}:${t}`,r),[m]),v=(0,r.useMemo)(()=>c.roles.includes("admin"),[c.roles]);(0,r.useEffect)(()=>{c.isAuthenticated&&!c.loading?h():c.isAuthenticated||h()},[]);let k=(0,r.useMemo)(()=>({...c,hasPermission:m,hasAnyPermission:f,hasAllPermissions:y,hasActionPermission:x,isAdmin:v,refresh:h,clearCache:p}),[c,m,f,y,x,v,h,p]);return(0,t.jsx)(i.Provider,{value:k,children:e})}function c(){let e=(0,r.useContext)(i);if(!e)throw Error("usePermissions must be used within PermissionProvider");return e}e.s(["PermissionProvider",()=>o,"usePermissions",()=>c])},16715,e=>{"use strict";let t=(0,e.i(75254).default)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);e.s(["RefreshCw",()=>t],16715)},55436,e=>{"use strict";let t=(0,e.i(75254).default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);e.s(["Search",()=>t],55436)},3116,e=>{"use strict";let t=(0,e.i(75254).default)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);e.s(["Clock",()=>t],3116)},63488,e=>{"use strict";let t=(0,e.i(75254).default)("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]]);e.s(["Mail",()=>t],63488)},73375,e=>{"use strict";let t=(0,e.i(75254).default)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);e.s(["ChevronLeft",()=>t],73375)},17923,e=>{"use strict";let t=(0,e.i(75254).default)("chart-column",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);e.s(["BarChart3",()=>t],17923)},91741,e=>{"use strict";let t=(0,e.i(75254).default)("clipboard-list",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);e.s(["ClipboardList",()=>t],91741)},98919,e=>{"use strict";let t=(0,e.i(75254).default)("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);e.s(["Shield",()=>t],98919)},70273,e=>{"use strict";let t=(0,e.i(75254).default)("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);e.s(["Star",()=>t],70273)},58041,e=>{"use strict";let t=(0,e.i(75254).default)("database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);e.s(["Database",()=>t],58041)},78583,e=>{"use strict";let t=(0,e.i(75254).default)("file-text",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);e.s(["FileText",()=>t],78583)},10400,e=>{"use strict";var t=e.i(43476),r=e.i(71645),s=e.i(9165),a=e.i(55600),i=e.i(93302),l=e.i(80580),n=e.i(7670),o=e.i(18566),c=e.i(73375),d=e.i(75254);let u=(0,d.default)("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]]);var h=e.i(17923),p=e.i(91741),m=e.i(3116);(0,d.default)("cog",[["path",{d:"M11 10.27 7 3.34",key:"16pf9h"}],["path",{d:"m11 13.73-4 6.93",key:"794ttg"}],["path",{d:"M12 22v-2",key:"1osdcq"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M14 12h8",key:"4f43i9"}],["path",{d:"m17 20.66-1-1.73",key:"eq3orb"}],["path",{d:"m17 3.34-1 1.73",key:"2wel8s"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"m20.66 17-1.73-1",key:"sg0v6f"}],["path",{d:"m20.66 7-1.73 1",key:"1ow05n"}],["path",{d:"m3.34 17 1.73-1",key:"nuk764"}],["path",{d:"m3.34 7 1.73 1",key:"1ulond"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["circle",{cx:"12",cy:"12",r:"8",key:"46899m"}]]);var f=e.i(58041),y=e.i(78583),x=e.i(67236);let v=(0,d.default)("gauge",[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]]);(0,d.default)("layout-dashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);var k=e.i(63488);let b=(0,d.default)("network",[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]]),g=(0,d.default)("radio",[["path",{d:"M16.247 7.761a6 6 0 0 1 0 8.478",key:"1fwjs5"}],["path",{d:"M19.075 4.933a10 10 0 0 1 0 14.134",key:"ehdyv1"}],["path",{d:"M4.925 19.067a10 10 0 0 1 0-14.134",key:"1q22gi"}],["path",{d:"M7.753 16.239a6 6 0 0 1 0-8.478",key:"r2q7qm"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);var w=e.i(98919);let j=(0,d.default)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);var M=e.i(61911);let N=(0,d.default)("workflow",[["rect",{width:"8",height:"8",x:"3",y:"3",rx:"2",key:"by2w9f"}],["path",{d:"M7 11v4a2 2 0 0 0 2 2h4",key:"xkn7yn"}],["rect",{width:"8",height:"8",x:"13",y:"13",rx:"2",key:"1cgmvn"}]]),C=[{title:"总览",items:[{label:"队列运维",href:"/queue-op",icon:v,permissions:["queue:read"]},{label:"RPC 调用",href:"/rpc-call",icon:g,permissions:["queue:read"]},{label:"定时任务",href:"/timing-jobs",icon:m.Clock,permissions:["queue:read"]}]},{title:"监控",items:[{label:"任务结果",href:"/fun-results",icon:f.Database,permissions:["queue:read"]},{label:"消费速率",href:"/consume-speed",icon:h.BarChart3,permissions:["queue:read"]},{label:"按 IP 查看消费者",href:"/running-consumers/ip",icon:b,permissions:["queue:read"]},{label:"按队列查看消费者",href:"/running-consumers/queue",icon:N,permissions:["queue:read"]},{label:"关于",href:"/about",icon:y.FileText},{label:"个人中心",href:"/profile",icon:j}]},{title:"系统管理",permissions:["user:read","role:read","project:read","audit:read","config:read"],items:[{label:"用户管理",href:"/admin/users",icon:M.Users,permissions:["user:read"]},{label:"角色管理",href:"/admin/roles",icon:w.Shield,permissions:["role:read"]},{label:"项目管理",href:"/admin/projects",icon:x.FolderKanban,permissions:["project:read"]},{label:"审计日志",href:"/admin/audit/logs",icon:p.ClipboardList,permissions:["audit:read"]},{label:"邮件配置",href:"/admin/email-config",icon:k.Mail,permissions:["config:read"]}]}];function S(e,t,r){if(e.has(r))return!0;for(let e of t)if(e.includes("*")&&RegExp("^"+e.replace(/[.+?^${}()|[\]\\]/g,"\\$&").replace(/\*/g,".*")+"$").test(r))return!0;return!1}var P=e.i(20777);function E({open:e,onClose:s}){let a=(0,o.usePathname)(),{permissions:l,loading:d}=(0,i.usePermissions)(),[h,p]=(0,r.useState)(!1);(0,r.useEffect)(()=>{p(!0)},[]);let m=(0,r.useMemo)(()=>{let e,t=new Set(l);return e=Array.from(t),C.map(r=>{var s;let a;if(r.permissions&&r.permissions.length>0&&!("all"===(r.permissionMode||"any")?r.permissions.every(r=>S(t,e,r)):r.permissions.some(r=>S(t,e,r))))return null;let i=(s=r.items,a=Array.from(t),s.filter(e=>{if(e.permissionExpression){let r=e.permissionExpression.split(/\s+AND\s+/i).map(e=>e.trim()).filter(e=>e.length>0),s=Array.from(t);return r.every(e=>S(t,s,e))}return!e.permissions||0===e.permissions.length||("all"===(e.permissionMode||"any")?e.permissions.every(e=>S(t,a,e)):e.permissions.some(e=>S(t,a,e)))}));return 0===i.length?null:{...r,items:i}}).filter(e=>null!==e)},[l]);return(0,t.jsx)("aside",{className:(0,n.default)("fixed left-0 top-0 z-40 h-full w-72 border-r border-[hsl(var(--line))] bg-[hsl(var(--card))]/75 backdrop-blur-2xl transition-transform duration-300",e?"translate-x-0":"-translate-x-full","md:translate-x-0"),children:(0,t.jsxs)("div",{className:"flex h-full flex-col px-6 py-8",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs font-semibold uppercase tracking-[0.4em] text-[hsl(var(--accent-2))]",children:"Funboost"}),(0,t.jsx)("h1",{className:"font-display text-xl text-[hsl(var(--ink))]",children:"管理控制台"})]}),(0,t.jsx)("button",{type:"button",onClick:s,className:"rounded-full border border-[hsl(var(--line))] p-2 text-[hsl(var(--ink-muted))] md:hidden",children:(0,t.jsx)(c.ChevronLeft,{className:"h-4 w-4"})})]}),(0,t.jsx)("nav",{className:"mt-8 flex-1 space-y-6 overflow-y-auto pr-2",children:d||!h?(0,t.jsx)("div",{className:"space-y-6",children:[1,2,3].map(e=>(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("div",{className:"h-3 w-16 animate-pulse rounded bg-[hsl(var(--sand-2))]"}),(0,t.jsx)("div",{className:"space-y-2",children:[1,2,3].map(e=>(0,t.jsx)("div",{className:"h-10 animate-pulse rounded-2xl bg-[hsl(var(--sand-2))]"},e))})]},e))}):m.map(e=>(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("p",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-[hsl(var(--ink-muted))]",children:e.title}),(0,t.jsx)("div",{className:"space-y-2",children:e.items.map(e=>{let r=a===e.href,s=e.icon;return(0,t.jsxs)(P.StaticLink,{href:e.href,className:(0,n.default)("flex items-center gap-3 rounded-2xl px-4 py-2 text-sm font-medium transition",r?"bg-[hsl(var(--accent-2))] text-white":"text-[hsl(var(--ink))] hover:bg-[hsl(var(--sand-2))]"),children:[(0,t.jsx)(s,{className:"h-4 w-4"}),e.label]},e.href)})})]},e.title))}),(0,t.jsxs)("div",{className:"mt-6 rounded-2xl border border-[hsl(var(--line))] bg-[hsl(var(--card))]/85 px-4 py-3 text-xs text-[hsl(var(--ink-muted))]",children:[(0,t.jsx)("p",{className:"font-semibold text-[hsl(var(--ink))]",children:"会话信息"}),(0,t.jsx)("p",{className:"mt-1",children:"账号设置请前往个人中心。"}),(0,t.jsxs)("button",{type:"button",onClick:()=>{window.location.href="/logout"},className:"mt-3 inline-flex items-center gap-2 rounded-full border border-[hsl(var(--line))] px-3 py-1 text-[11px] font-semibold uppercase tracking-[0.2em] text-[hsl(var(--ink))] hover:border-[hsl(var(--accent))] hover:text-[hsl(var(--accent))]",children:[(0,t.jsx)(u,{className:"h-3.5 w-3.5"}),"退出登录"]})]})]})})}let A=(0,d.default)("menu",[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]]);var _=e.i(16715),$=e.i(55436),q=e.i(70273);let L=(0,d.default)("moon",[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]]),T=(0,d.default)("sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);var z=e.i(1844);function R(){let[e,s]=(0,r.useState)("light");(0,r.useEffect)(()=>{let e=(0,z.getStoredTheme)()??(0,z.getSystemTheme)();s(e),(0,z.applyTheme)(e)},[]);let a="dark"===e;return(0,t.jsxs)("button",{type:"button",onClick:()=>{let t="dark"===e?"light":"dark";s(t),(0,z.applyTheme)(t),(0,z.setStoredTheme)(t)},"aria-pressed":a,"aria-label":`切换为${a?"亮色":"暗色"}模式`,className:(0,n.default)("inline-flex items-center gap-2 rounded-full border border-[hsl(var(--line))] bg-[hsl(var(--card))]/80 px-3 py-1 text-[11px] font-semibold","uppercase tracking-[0.18em] text-[hsl(var(--ink))] transition hover:border-[hsl(var(--accent))]","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-[hsl(var(--accent))] focus-visible:ring-offset-2 focus-visible:ring-offset-[hsl(var(--sand))]"),children:[(0,t.jsx)("span",{children:a?"暗色":"亮色"}),a?(0,t.jsx)(L,{className:"h-3.5 w-3.5 text-[hsl(var(--accent-2))]"}):(0,t.jsx)(T,{className:"h-3.5 w-3.5 text-[hsl(var(--accent-3))]"})]})}let F={"/queue-op":{title:"队列运维",subtitle:"管理队列、消费者与实时指标。"},"/rpc-call":{title:"RPC 控制台",subtitle:"发送请求并追踪任务结果。"},"/timing-jobs":{title:"定时任务",subtitle:"创建、暂停并监控任务。"},"/care-project":{title:"关注项目",subtitle:"限定监控范围到指定项目。"},"/fun-results":{title:"任务结果",subtitle:"查看执行结果与重试情况。"},"/consume-speed":{title:"消费速率",subtitle:"分析队列吞吐趋势。"},"/running-consumers/ip":{title:"按 IP 查看消费者",subtitle:"按主机分组查看进程。"},"/running-consumers/queue":{title:"按队列查看消费者",subtitle:"按队列查看活跃消费端。"},"/about":{title:"关于",subtitle:"数据来源说明与注意事项。"},"/admin/users":{title:"用户管理",subtitle:"管理用户、锁定与密码。"},"/admin/roles":{title:"角色管理",subtitle:"按角色分配权限。"},"/admin/projects":{title:"项目管理",subtitle:"管理项目与成员权限。"},"/admin/audit/logs":{title:"审计日志",subtitle:"筛选并查看审计事件。"},"/admin/audit/config":{title:"审计配置",subtitle:"保留策略与清理设置。"},"/admin/audit/statistics":{title:"审计统计",subtitle:"登录与操作概览。"},"/admin/email-config":{title:"邮件配置",subtitle:"SMTP 设置与测试邮件。"},"/profile":{title:"个人中心",subtitle:"账户概览与安全设置。"},"/profile/change-password":{title:"修改密码",subtitle:"安全更新你的密码。"},"/profile/change-email":{title:"修改邮箱",subtitle:"验证并更新邮箱地址。"}};function H({onMenu:e}){let a=(0,o.usePathname)(),[i,l]=(0,r.useState)(""),[c,d]=(0,r.useState)(!1),u=async()=>{d(!0);try{let e=await (0,s.funboostFetch)("/funboost/get_care_project_name",{cache:"no-store"});l(e?.care_project_name||"")}catch{l("")}finally{d(!1)}};(0,r.useEffect)(()=>{u();let e=e=>{let t=e.detail;t&&"string"==typeof t.careProjectName?l(t.careProjectName||""):u()};return window.addEventListener("careProjectChanged",e),()=>{window.removeEventListener("careProjectChanged",e)}},[]);let h=F[a]||{title:"Funboost 管理控制台",subtitle:"分布式函数的监控与调度中心。"};return(0,t.jsxs)("header",{className:"flex flex-wrap items-center justify-between gap-4 border-b border-[hsl(var(--line))] bg-[hsl(var(--card))]/70 px-6 py-4 backdrop-blur-2xl",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("button",{type:"button",onClick:e,className:"rounded-full border border-[hsl(var(--line))] p-2 text-[hsl(var(--ink))] md:hidden",children:(0,t.jsx)(A,{className:"h-4 w-4"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"font-display text-xl text-[hsl(var(--ink))]",children:h.title}),(0,t.jsx)("p",{className:"text-sm text-[hsl(var(--ink-muted))]",children:h.subtitle})]})]}),(0,t.jsxs)("div",{className:"flex w-full items-center gap-3 md:w-auto",children:[(0,t.jsxs)(P.StaticLink,{href:"/care-project",className:(0,n.default)("flex items-center gap-2 rounded-full border px-4 py-2 text-sm font-medium transition",i?"border-[hsl(var(--accent))] bg-[hsl(var(--accent))]/20 text-[hsl(var(--accent-2))]":"border-[hsl(var(--line))] bg-[hsl(var(--card))]/80 text-[hsl(var(--ink-muted))] hover:border-[hsl(var(--accent))]/50"),children:[(0,t.jsx)(q.Star,{className:(0,n.default)("h-4 w-4",i&&"fill-current")}),(0,t.jsx)("span",{children:i||"全部项目"}),(0,t.jsx)("button",{type:"button",onClick:e=>{e.preventDefault(),e.stopPropagation(),u()},className:"rounded-full p-0.5 hover:bg-[hsl(var(--accent))]/20",children:(0,t.jsx)(_.RefreshCw,{className:(0,n.default)("h-3.5 w-3.5",c&&"animate-spin")})})]}),(0,t.jsxs)("div",{className:"flex flex-1 items-center gap-2 rounded-full border border-[hsl(var(--line))] bg-[hsl(var(--card))]/80 px-4 py-2 text-sm text-[hsl(var(--ink-muted))] md:w-72",children:[(0,t.jsx)($.Search,{className:"h-4 w-4"}),(0,t.jsx)("input",{className:"w-full bg-transparent text-sm text-[hsl(var(--ink))] outline-none",placeholder:"搜索队列、任务、用户"})]}),(0,t.jsx)(R,{})]})]})}function I({children:e}){let[n,o]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{(async()=>{try{(await (0,s.apiFetch)("/api/profile",{method:"GET"})).success||(0,a.navigateTo)("/login")}catch{(0,a.navigateTo)("/login")}})()},[]),(0,t.jsx)(i.PermissionProvider,{children:(0,t.jsx)(l.ProjectProvider,{children:(0,t.jsxs)("div",{className:"min-h-screen",children:[(0,t.jsx)(E,{open:n,onClose:()=>o(!1)}),(0,t.jsxs)("div",{className:"min-h-screen md:pl-72",children:[(0,t.jsx)(H,{onMenu:()=>o(!0)}),(0,t.jsx)("main",{className:"space-y-10 px-6 py-10 fade-in",children:e})]})]})})})}e.s(["AppShell",()=>I],10400)}]);