(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,59544,e=>{"use strict";var s=e.i(43476),r=e.i(7670);let t={primary:"bg-[hsl(var(--accent))] text-white hover:bg-[hsl(var(--accent-2))]",secondary:"bg-[hsl(var(--accent-2))] text-white hover:bg-[hsl(var(--accent))]",outline:"border border-[hsl(var(--line))] text-[hsl(var(--ink))] hover:border-[hsl(var(--accent))] hover:text-[hsl(var(--accent))]",ghost:"text-[hsl(var(--ink))] hover:bg-[hsl(var(--sand-2))]",danger:"bg-[hsl(var(--danger))] text-white hover:bg-[hsl(var(--danger))]/90",success:"bg-[hsl(var(--success))] text-white hover:bg-[hsl(var(--success))]/90",warning:"bg-[hsl(var(--warning))] text-white hover:bg-[hsl(var(--warning))]/90"},a={sm:"px-3 py-1.5 text-xs",md:"px-4 py-2 text-sm",lg:"px-5 py-2.5 text-sm"};function n({variant:e="primary",size:n="md",className:l,...i}){return(0,s.jsx)("button",{className:(0,r.default)("inline-flex items-center justify-center gap-2 rounded-full font-medium transition-colors duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-[hsl(var(--accent))] focus-visible:ring-offset-2 focus-visible:ring-offset-[hsl(var(--sand))]",t[e],a[n],l),...i})}e.s(["Button",()=>n])},39964,e=>{"use strict";var s=e.i(43476),r=e.i(7670);function t({glass:e=!0,className:t,...a}){return(0,s.jsx)("div",{className:(0,r.default)("rounded-3xl p-6",e?"glass-card":"bg-[hsl(var(--card))] border border-[hsl(var(--line))]",t),...a})}e.s(["Card",()=>t])},3812,e=>{"use strict";var s=e.i(43476),r=e.i(7670);function t({className:e,...t}){return(0,s.jsx)("input",{className:(0,r.default)("w-full rounded-2xl border border-[hsl(var(--line))] bg-[hsl(var(--card))]/80 px-4 py-2 text-sm text-[hsl(var(--ink))] shadow-sm outline-none transition placeholder:text-[hsl(var(--ink-muted))] focus:border-[hsl(var(--accent))] focus:ring-2 focus:ring-[hsl(var(--accent))]/20",e),...t})}e.s(["Input",()=>t])},34252,e=>{"use strict";var s=e.i(47167);let r=s.default.env.NEXT_PUBLIC_API_BASE??"",t=new Set(["localhost","127.0.0.1","::1"]);function a(){let e;if("true"===new URLSearchParams(window.location.search).get("allow_insecure")||"true"===s.default.env.NEXT_PUBLIC_ALLOW_INSECURE_PASSWORD)return{ok:!0,warning:"已开启不安全密码传输，仅用于内网环境。"};let a=window.location.origin,n=r?new URL(r,a):new URL(a),l=(e=n.hostname,t.has(e)),i="https:"===n.protocol;return/^(192\.168\.|10\.|172\.(1[6-9]|2[0-9]|3[01])\.)/.test(n.hostname)?{ok:!0,warning:"当前为内网环境，密码将以明文提交。"}:window.isSecureContext||l?i||l?!i&&l?{ok:!0,warning:"当前为本地开发环境，密码将以明文提交，请勿用于生产环境。"}:{ok:!0}:{ok:!1,message:"检测到后端为非 HTTPS，已阻止提交。请启用 HTTPS。"}:{ok:!1,message:"当前页面不是安全上下文，已阻止提交。请使用 HTTPS 访问前端。"}}e.s(["ensureSecurePasswordTransport",()=>a])},83314,e=>{"use strict";var s=e.i(47167),r=e.i(43476),t=e.i(71645),a=e.i(59544),n=e.i(39964),l=e.i(3812),i=e.i(34252),o=e.i(55600);function c(){let[e,c]=(0,t.useState)(""),[u,d]=(0,t.useState)(""),[h,v]=(0,t.useState)(""),[g,p]=(0,t.useState)(null),[x,m]=(0,t.useState)(null),[b,f]=(0,t.useState)(!1),w=async r=>{if(r.preventDefault(),p(null),m(null),u!==h)return void p("两次输入的密码不一致。");f(!0);try{let r=(0,i.ensureSecurePasswordTransport)();if(!r.ok){p(r.message??"密码传输不安全。"),f(!1);return}r.warning&&m(r.warning);let t=new FormData;t.append("current_password",e),t.append("new_password",u),t.append("confirm_password",h),await fetch(`${s.default.env.NEXT_PUBLIC_API_BASE??""}/profile/change-password`,{method:"POST",body:t,credentials:"include"}),(0,o.navigateTo)("/profile")}catch(e){p(e instanceof Error?e.message:"更新失败。")}finally{f(!1)}};return(0,r.jsxs)("div",{className:"space-y-6",children:[g?(0,r.jsx)(n.Card,{className:"border border-[hsl(var(--danger))]/30 bg-[hsl(var(--danger))]/10 text-sm text-[hsl(var(--danger))]",children:g}):null,x?(0,r.jsx)(n.Card,{className:"border border-[hsl(var(--warning))]/30 bg-[hsl(var(--warning))]/10 text-sm text-[hsl(var(--warning))]",children:x}):null,(0,r.jsx)(n.Card,{children:(0,r.jsxs)("form",{className:"space-y-4",onSubmit:w,children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"text-xs font-semibold uppercase tracking-[0.2em] text-[hsl(var(--ink-muted))]",children:"当前密码"}),(0,r.jsx)(l.Input,{type:"password",value:e,onChange:e=>c(e.target.value),required:!0})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"text-xs font-semibold uppercase tracking-[0.2em] text-[hsl(var(--ink-muted))]",children:"新密码"}),(0,r.jsx)(l.Input,{type:"password",value:u,onChange:e=>d(e.target.value),required:!0})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"text-xs font-semibold uppercase tracking-[0.2em] text-[hsl(var(--ink-muted))]",children:"确认新密码"}),(0,r.jsx)(l.Input,{type:"password",value:h,onChange:e=>v(e.target.value),required:!0})]}),(0,r.jsx)(a.Button,{type:"submit",disabled:b,children:b?"正在保存...":"保存"})]})})]})}e.s(["default",()=>c])}]);